<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Hieu's blog</title>
    <description>This is a blog about Linux, Database, Infrastructure, some mathematics, and mindset.</description>
    <link>https://llnx.me/</link>
    <atom:link href="https://llnx.me/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Mon, 29 Oct 2018 23:03:55 +0700</pubDate>
    <lastBuildDate>Mon, 29 Oct 2018 23:03:55 +0700</lastBuildDate>
    <generator>Jekyll v3.5.1</generator>
    
      <item>
        <title>Debian on android shell</title>
        <description>&lt;p&gt;&lt;strong&gt;Goal&lt;/strong&gt;: I had one old Android phone, with broken touching/gesture layer. One day, I found it on a dirty old place.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;I wonder how can I make it better with more usability.&lt;/li&gt;
  &lt;li&gt;How can I make it work exactly as I needed.&lt;/li&gt;
  &lt;li&gt;How can I transform this old phone to a super tiny linux machine with interactive shell?&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Device: xiaomi Mi4W LTE, android 6.0.1 MMB29M
Specs: Qualcomm MSM8974PRO-AC Quad-core max 2.5GHz, 3.00 GB memory, 16GB disk
Kernel: 3.4.0-gf4b741d-00690-gc8911e
Arch: armv7l
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/android-shell.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;!--description--&gt;

&lt;h2 id=&quot;a-knowledge-base&quot;&gt;A. Knowledge base&lt;/h2&gt;

&lt;p&gt;For accessing default android shell, we need &lt;code class=&quot;highlighter-rouge&quot;&gt;adb&lt;/code&gt; tools. For booting operation with custom image, we use &lt;code class=&quot;highlighter-rouge&quot;&gt;fastboot&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;adb reboot recovery&lt;/code&gt;.
After accessing, with &lt;code class=&quot;highlighter-rouge&quot;&gt;twrp&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;supersu&lt;/code&gt; we can grant &lt;code class=&quot;highlighter-rouge&quot;&gt;root&lt;/code&gt; privileges because we need root permission for doing &lt;code class=&quot;highlighter-rouge&quot;&gt;mount&lt;/code&gt; filesystem and totally control the whole system.&lt;/p&gt;

&lt;p&gt;We also need &lt;code class=&quot;highlighter-rouge&quot;&gt;busybox&lt;/code&gt; for expanding utilities like editing files by &lt;code class=&quot;highlighter-rouge&quot;&gt;vi&lt;/code&gt;, checking network connection, …
It’s done for controlling android via &lt;code class=&quot;highlighter-rouge&quot;&gt;adb shell&lt;/code&gt;, but currently, linux os on android is designed for mobile, apk applications, everyday carry and easy to use for all kinds of users, also it’s not using any kind of package management like &lt;code class=&quot;highlighter-rouge&quot;&gt;apt&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;yum&lt;/code&gt;, I nearly can do nothing on current system.&lt;/p&gt;

&lt;p&gt;From devops/sre point of view, all I want is pushing/booting a fully &lt;code class=&quot;highlighter-rouge&quot;&gt;linux&lt;/code&gt; os to my android, that’s I can do more things on this, instead of limited android os.
I decided to use &lt;code class=&quot;highlighter-rouge&quot;&gt;debian stretch&lt;/code&gt; with &lt;code class=&quot;highlighter-rouge&quot;&gt;debootrap&lt;/code&gt; for extract custom image and init debian filesystem via &lt;code class=&quot;highlighter-rouge&quot;&gt;chroot&lt;/code&gt; to current android &lt;code class=&quot;highlighter-rouge&quot;&gt;sdcard&lt;/code&gt; directory.&lt;/p&gt;

&lt;h2 id=&quot;b-hacking--practicing-zone&quot;&gt;B. Hacking / Practicing zone&lt;/h2&gt;

&lt;h3 id=&quot;1-install-adb-and-fastboot-tools-on-mac&quot;&gt;1. Install adb and fastboot tools on mac&lt;/h3&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mac❯❯ brew cask install android-platform-tools

mac❯❯ adb --version
Android Debug Bridge version 1.0.40
Version 4797878
Installed as /usr/local/bin/adb

mac❯❯ fastboot --version
fastboot version 28.0.0-4797878
Installed as /usr/local/bin/fastboot

# Connect android to mac via usb 
# Verify device

mac❯❯ adb devices -l
List of devices attached
1f703708  device usb:336592896X product:cancro_wc_lte model:MI_4W device:cancro transport_id:13
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;2-download-then-install-twrp--supersu-on-fastboot&quot;&gt;2. Download then install twrp &amp;amp; supersu on fastboot&lt;/h3&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mac❯❯ wget internet.com/SR5-SuperSU-v2.82-SR5-20171001224502.zip ./
mac❯❯ wget internet.com/twrp-3.1.0-0-cancro.img ./
mac❯❯ adb push ./SR5-SuperSU-v2.82-SR5-20171001224502.zip /storage/self/primary/
SR5-SuperSU-v2.82-SR5-20171001224502.zip: 1 file pushed. 5.8 MB/s (6882992 bytes in 1.127s)

mac❯❯ adb reboot bootloader

mac❯❯ fastboot devices
1f703708	fastboot

mac❯❯ fastboot flash recovery ./twrp-3.1.0-0-cancro.img
Sending 'recovery' (13682 KB)                      OKAY [  0.464s]
Writing 'recovery'                                 OKAY [  0.305s]
Finished. Total time: 0.772s

mac❯❯ fastboot boot ./twrp-3.1.0-0-cancro.img
Downloading 'boot.img'                             OKAY [  0.432s]
booting                                            OKAY [  0.119s]
Finished. Total time: 0.560s

# After booted into TWRP
# Install SR5-SuperSU-v2.82-SR5-20171001224502.zip from TWRP
# Do it on touch screen, or via twrp commandline

mac❯❯ adb shell 
android❯❯ twrp install /storage/self/primary/SR5-SuperSU-v2.82-SR5-20171001224502.zip
android❯❯ twrp wipe cache
android❯❯ reboot

# Verify root on device

mac❯❯ adb shell
shell@cancro:/ $ su -
root@cancro:/ # whoami
root
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;3-expand-utilities-with-busybox&quot;&gt;3. Expand utilities with busybox&lt;/h3&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mac❯❯ wget https://busybox.net/downloads/binaries/1.28.1-defconfig-multiarch/busybox-armv7l
mac❯❯ adb push busybox-armv7l /data/local/tmp
busybox-armv7l: 1 file pushed. 3.8 MB/s (1079156 bytes in 0.270s)

mac❯❯ adb shell
shell@cancro:/ $ su -
root@cancro:/ # mkdir /data/busybox
root@cancro:/ # move /data/local/tmp/busybox-armv7l /data/busybox
root@cancro:/ # cd /data/busybox
root@cancro:/data/busybox # ls -l
-rwxrwxrwx shell    shell     1079156 2018-02-15 20:47 busybox-armv7l
root@cancro:/data/busybox # ./busybox-armv7l --install ./

# Use ls of busybox 
# instead of current ls on android

root@cancro:/ # which ls
/system/bin/ls

root@cancro:/ # export PATH=/data/busybox:$PATH
root@cancro:/ # which ls
/data/busybox/ls
root@cancro:/ # which vi
/data/busybox/vi
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;4-config--fix-env-variables-and-configuations&quot;&gt;4. Config / fix env variables and configuations&lt;/h3&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Choose one: (for security mount /system back to RO when finished)
# Mount system RW: mount -o rw,remount /system
# Mount system RO: mount -o ro,remount /system

root@cancro:/ # mount -o rw,remount /system
root@cancro:/ # vi /system/etc/mkshrc
...
export PATH=/data/busybox:$PATH
...
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;when facing with su command like this, we need reconfigure su&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Issue with su command

shell@cancro:/ $ su
su: must be suid to work properly

# Resolve

root@cancro:/ # cp /su/bin/su /data/busybox/su
root@cancro:/ # ls -lh /su/bin/su
-rwxr-xr-x    1 0        0          73.6K Sep 11 13:49 /su/bin/su
root@cancro:/ # ls -lh /data/busybox/su
-rwx------    1 0        0          73.6K Sep 11 15:58 /data/busybox/su
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;5-extract-debianimg-from-available-debian-system-not-bsd-os-like-mac&quot;&gt;5. Extract debian.img from available debian system (not BSD os like Mac)&lt;/h3&gt;

&lt;p&gt;Install debootstrap then bootstrapping debian stretch image for armv7l arch&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;debian❯❯ apt install -y debootstrap debian-archive-keyring debian-ports-archive-keyring
debian❯❯ mkdir debian-armhf
debian❯❯ cd debian-armhf/
debian❯❯ dd if=/dev/zero of=debian.img seek=749999999 bs=1 count=1
debian❯❯ mke2fs -F debian.img
debian❯❯ mkdir debian
debian❯❯ mount -o loop debian.img debian
debian❯❯ debootstrap --arch armhf --foreign --verbose stretch debian http://ftp.us.debian.org/debian
debian❯❯ umount debian
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;rsync file debian.img from debian system to mac system, then push this img to android&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mac❯❯ adb push debian.img /sdcard/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;6-debootstrapping-debian-into-android-os&quot;&gt;6. Debootstrapping debian into android os&lt;/h3&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mac❯❯ adb shell

shell@cancro:/ $ su -
root@cancro:/ # mkdir /sdcard/debian-stretch9
root@cancro:/ # losetup /dev/block/loop99 /sdcard/debian.img
root@cancro:/ # mount /dev/block/loop99 /sdcard/debian-stretch9
root@cancro:/ # chroot /sdcard/debian-stretch9 /bin/bash

export PATH=/usr/bin:/usr/sbin:/bin:$PATH
export TERM=linux
export HOME=/root
export USER=root
/debootstrap/debootstrap --second-stage

echo &quot;nameserver 8.8.8.8&quot; &amp;gt;&amp;gt; /etc/resolv.conf
echo &quot;127.0.0.1 localhost&quot; &amp;gt; /etc/hosts
exit

mac❯❯ adb shell
shell@cancro:/ $ su -
root@cancro:/ # chroot /sdcard/debian-stretch9 /bin/su - root
root@localhost:~# whoami #should be root
root@localhost:~# cat /etc/debian_version #9.5
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;7-complete-debian-os-with-apt-and-networking&quot;&gt;7. Complete debian os with apt and networking&lt;/h3&gt;
&lt;p&gt;From the first time, I cannot use &lt;code class=&quot;highlighter-rouge&quot;&gt;ping&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;apt&lt;/code&gt;, because Android uses a special Kernel patch that’s activated with &lt;code class=&quot;highlighter-rouge&quot;&gt;CONFIG_ANDROID_PARANOID_NETWORK&lt;/code&gt;. 
For adding specific groups, this patch allows network access to system users that belong to certain special groups with hardcoded IDs.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mac❯❯ adb shell
shell@cancro:/ $ su -
root@cancro:/ # chroot /sdcard/debian-stretch9/ /bin/su - root

root@localhost:~# groupadd -g 3001 aid_bt
root@localhost:~# groupadd -g 3002 aid_bt_net
root@localhost:~# groupadd -g 3003 aid_inet
root@localhost:~# groupadd -g 3004 aid_net_raw
root@localhost:~# groupadd -g 3005 aid_admin
root@localhost:~# usermod -a -G aid_bt,aid_bt_net,aid_inet,aid_net_raw,aid_admin root
exit - relogin

root@localhost:~# grep -E &quot;_apt&quot; /etc/passwd
_apt:x:104:65534::/nonexistent:/bin/false

root@localhost:~# usermod -g 3003 _apt
root@localhost:~# grep -E &quot;_apt&quot; /etc/passwd
_apt:x:104:3003::/nonexistent:/bin/false

root@localhost:~# apt update
Ign:1 http://ftp.de.debian.org/pub/debian stable InRelease
Get:2 http://ftp.de.debian.org/pub/debian stable Release [118 kB]
...
Fetched 12.7 MB in 36s (351 kB/s)
Reading package lists... Done
Building dependency tree... Done
All packages are up to date.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;8-performance-benchmarking&quot;&gt;8. Performance benchmarking&lt;/h3&gt;
&lt;p&gt;…to be continue&lt;/p&gt;

&lt;h2 id=&quot;c-reference&quot;&gt;C. Reference&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.wikitechy.com/technology/how-to-root-and-install-twrp-recovery-on-xiaomi-mi4/&quot;&gt;TWRP fastboot&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://android.stackexchange.com/questions/53389/can-i-update-the-adb-shells-environment-variables&quot;&gt;ADB shell environment&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://android.stackexchange.com/questions/110927/how-to-mount-system-rewritable-or-read-only-rw-ro&quot;&gt;Mount /system RR&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://busybox.net/FAQ.html&quot;&gt;Busybox FAQ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cryptojedi.org/misc/nexuss-debian.shtml&quot;&gt;Debian on android&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/36451444/what-can-cause-a-socket-permission-denied-error&quot;&gt;Chroot on android&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Tue, 11 Sep 2018 00:00:00 +0700</pubDate>
        <link>https://llnx.me/technical/2018/09/11/Debian-on-android-shell.html</link>
        <guid isPermaLink="true">https://llnx.me/technical/2018/09/11/Debian-on-android-shell.html</guid>
        
        
        <category>technical</category>
        
      </item>
    
      <item>
        <title>Solving blaming game</title>
        <description>&lt;p&gt;&lt;strong&gt;Context&lt;/strong&gt;: stuck with problems, cannot find root cause, dunno and cannot understand and reproduce problem. Maybe feeling very tired for a long day, already taken 5 hours without any good executions. Maybe you don’t want to take responsibility for that.&lt;/p&gt;

&lt;p&gt;Introducing &lt;strong&gt;blaming&lt;/strong&gt;: the fine art of making others responsible for all the difficult things that happen to you.&lt;/p&gt;

&lt;p&gt;Nowadays, there are many many contexts &amp;amp; examples for blaming. I only want to wide the scope of this mindset, into SRE/Devops/Sysadmin fields. &lt;strong&gt;Why we blaming each others&lt;/strong&gt;, right or wrong? How can we fix/improve our mindset? &lt;strong&gt;How can we do better?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://imgs.xkcd.com/comics/blame_2x.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;!--description--&gt;

&lt;h2 id=&quot;1-real-life-example&quot;&gt;1. Real life example&lt;/h2&gt;

&lt;p&gt;Working on infras of someone else, working on services that not be built by ourself&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;many legacy/unknown components&lt;/li&gt;
  &lt;li&gt;bad naming &amp;amp; coding conventions&lt;/li&gt;
  &lt;li&gt;lack of resource inventory, lack of useful documents.&lt;/li&gt;
  &lt;li&gt;found bad lines of code from developers, but must solve that shitty issue.&lt;/li&gt;
  &lt;li&gt;found unacceptable implementations, like opened all ports, all protocols to 0.0.0.0/0 &lt;strong&gt;(WTF)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We start blaming others because they are bad, very bad&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Who did it?&lt;/li&gt;
  &lt;li&gt;Who’s the interviewer of that f*cker guy?&lt;/li&gt;
  &lt;li&gt;Hey man, you mad, go fuck yourself&lt;/li&gt;
  &lt;li&gt;Kick this man out please, I don’t want him in my team&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;2-reasons&quot;&gt;2. Reasons&lt;/h2&gt;

&lt;h3 id=&quot;a-badness&quot;&gt;a. Badness&lt;/h3&gt;

&lt;p&gt;We have a deep need for a sense of identity, and one way we do this is through social comparison, contrasting ourselves against others. 
If we can place ourselves higher in the pecking order of society then we can feel more important and have a greater sense of control.&lt;/p&gt;

&lt;p&gt;We seek a higher status than others. And blame is one of the tools we use to this end. If the other person is bad, then it seems &lt;strong&gt;we must be relatively good&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://media.giphy.com/media/xzMs8O1KQh17i/giphy.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;b-defending&quot;&gt;b. Defending&lt;/h3&gt;

&lt;p&gt;Maybe we’re &lt;strong&gt;scared&lt;/strong&gt; that we’re going to fall, because if our boss found this issue, we will be fire, or cannot have a higher salary. If we are not at fault, we &lt;strong&gt;blame to defend&lt;/strong&gt;. If we are at fault, then we &lt;strong&gt;blame to deflect&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://media.giphy.com/media/3o6vXSO55Ib7Tm4NLW/giphy.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;c-attacking&quot;&gt;c. Attacking&lt;/h3&gt;

&lt;p&gt;Sometimes we know the reasons of issues are most from our side, but also come from their side.
We want to blame others less because we are moving attention away from ourselves and more because we &lt;strong&gt;specifically want to attack others&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;A common reason to attack others is that we have some grudge against them, believing them to be bad or unworthy in some way and hence deserving punishment. Perhaps they have blamed us unfairly in past. Maybe they have hurt one of our friends. In any case, the opportunity to blame is used as a convenient method of subtle attack.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://media.giphy.com/media/xT39D97sOyaJ8CJlD2/giphy.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;3-how-can-we-do-better&quot;&gt;3. How can we do better?&lt;/h2&gt;

&lt;p&gt;The keys aka solutions are &lt;strong&gt;NO BLAMING GAME&lt;/strong&gt; + &lt;strong&gt;JUST FIX THAT SHIT&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;You are good&lt;/strong&gt;, very good enough to know the bad (after taken 10 hours for finding rootcause)
Why don’t you sit down and plan to solve issues?
Calm down, breath, take a deep breath, let’s standup and take a coffee/tea cup, then relax your mind.&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;I recommended that you should &lt;strong&gt;switch&lt;/strong&gt; your mindset from blaming others to &lt;strong&gt;thinking that you have a change to make things better&lt;/strong&gt;. You are here to do that, you have a change to show off your experiences (devops god, hero of all things)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Figure out the problem&lt;/strong&gt;, &lt;strong&gt;plan a hotfix&lt;/strong&gt;, write-up &amp;amp; share &lt;strong&gt;step-by-step&lt;/strong&gt;, guide the fucker to understand and &lt;strong&gt;how to find root cause&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Even the f*cker is developer or other junior devops/sysdmin. They are bad, lack of knowledge.
Your job is inspecting, finding, &lt;strong&gt;solving&lt;/strong&gt;, validating, auditing, &lt;strong&gt;not pointing the figure elsewhere.&lt;/strong&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Disclamer and question&lt;/strong&gt;:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;If you cannot solve issues, it means you don’t have enough permission and knowledge to blame. RIGHT?&lt;/li&gt;
  &lt;li&gt;Blaming or not blaming, at the end, issues still right there. Blaming is not solving problems.&lt;/li&gt;
  &lt;li&gt;Why dont we sit down then try to fix that shit?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://media.giphy.com/media/l4q8gzOgUQIy7Ml44/giphy.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;http://changingminds.org/explanations/behaviors/blame/why_blame_others.htm&quot;&gt;http://changingminds.org/explanations/behaviors/blame/why_blame_others.htm&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.harleytherapy.co.uk/counselling/why-we-put-the-blame-on-others.htm&quot;&gt;https://www.harleytherapy.co.uk/counselling/why-we-put-the-blame-on-others.htm&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Sat, 25 Aug 2018 00:00:00 +0700</pubDate>
        <link>https://llnx.me/mindset/2018/08/25/Solving-blaming-game.html</link>
        <guid isPermaLink="true">https://llnx.me/mindset/2018/08/25/Solving-blaming-game.html</guid>
        
        
        <category>mindset</category>
        
      </item>
    
      <item>
        <title>Signal of linux</title>
        <description>&lt;h3 id=&quot;definition&quot;&gt;Definition:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;System calls: communication chanel between user space program and kernel&lt;/li&gt;
  &lt;li&gt;Signals: a different channel, used for inter-process communication&lt;/li&gt;
  &lt;li&gt;Signals don’t carry any agrgument, they are self explanatory by their name&lt;/li&gt;
  &lt;li&gt;Some signals identified by a number, ie &lt;code class=&quot;highlighter-rouge&quot;&gt;SIGKILL&lt;/code&gt; (9)&lt;/li&gt;
  &lt;li&gt;That’s why we use &lt;code class=&quot;highlighter-rouge&quot;&gt;kill -9 &amp;lt;PID&amp;gt;&lt;/code&gt; to kill a process, because the kill command will send a defined signal to a process with a given identity &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;PID&amp;gt;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;when we run &lt;code class=&quot;highlighter-rouge&quot;&gt;kill -9 &amp;lt;PID&amp;gt;&lt;/code&gt; command, that process is not terminate itself, instead we’re telling that OS to stop running the program, no matter what the program is doing&lt;/li&gt;
&lt;/ul&gt;

&lt;!--description--&gt;

&lt;h3 id=&quot;some-useful-signals&quot;&gt;Some useful signals&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SIGINT&lt;/code&gt;: is the program interrupt signal. When user presses &lt;code class=&quot;highlighter-rouge&quot;&gt;CTRL+C&lt;/code&gt;, the terminal emulator sends this signal to the foreground process, it will terminate process, but it can be caught or ignored, it a graceful shutdown&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SIGTERM&lt;/code&gt;: is the termination signal. It used to cause process termination, this signal can be blocked, handled and ignored. It is the normal way to ask a process to terminate. The &lt;code class=&quot;highlighter-rouge&quot;&gt;kill&lt;/code&gt; command generates SIGTERM by default&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SIGKILL&lt;/code&gt;: is an immediate termination signal. It cannot be caught or ignored by the process, because when we send a &lt;code class=&quot;highlighter-rouge&quot;&gt;SIGKILL&lt;/code&gt; to a proces, we remove any chance for that process to do a tidy cleanup and shutdown.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For example, when a process does not die by using &lt;code class=&quot;highlighter-rouge&quot;&gt;Ctrl+C&lt;/code&gt; (SIGINT), we should use the command &lt;code class=&quot;highlighter-rouge&quot;&gt;kill -9&lt;/code&gt; on that process PID&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SIGSTOP&lt;/code&gt;: is a process suspend signal, which tells the OS to stop/suspend a process. This signal cannot be caught or ignored. To resume the process, use SIGCONT signal to continue&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Ctrl+C&lt;/code&gt;: The interrupt signal, sends &lt;code class=&quot;highlighter-rouge&quot;&gt;SIGINT&lt;/code&gt; to the job running in the foreground.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When a process is in a limbo state it is reasonable to send the process the &lt;code class=&quot;highlighter-rouge&quot;&gt;SIGKILL&lt;/code&gt; signal, which can be invoked by running the kill command with the -9 flag. Unlike &lt;code class=&quot;highlighter-rouge&quot;&gt;SIGTERM&lt;/code&gt; the &lt;code class=&quot;highlighter-rouge&quot;&gt;SIGKILL&lt;/code&gt; signal cannot be captured by the process and thus it cannot be ignored. The &lt;code class=&quot;highlighter-rouge&quot;&gt;SIGKILL&lt;/code&gt; signal is handled outside of the process completely, and is used to stop the process immediately. The problem with using &lt;code class=&quot;highlighter-rouge&quot;&gt;SIGKILL&lt;/code&gt; is that it does not allow an application to close its open files or database connections cleanly and over time could cause other issues; therefor it is generally better to reserve the &lt;code class=&quot;highlighter-rouge&quot;&gt;SIGKILL&lt;/code&gt; signal as a last resort.&lt;/p&gt;

&lt;h3 id=&quot;reference--read-more&quot;&gt;Reference &amp;amp; Read more&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;http://bencane.com/2014/04/01/understanding-the-kill-command-and-how-to-terminate-processes-in-linux/&lt;/li&gt;
  &lt;li&gt;https://en.wikipedia.org/wiki/Unix_signal&lt;/li&gt;
  &lt;li&gt;http://unix.stackexchange.com/questions/149741/why-is-sigint-not-propagated-to-child-process-when-sent-to-its-parent-process&lt;/li&gt;
  &lt;li&gt;http://askubuntu.com/questions/890591/why-doesnt-ctrl-c-kill-the-terminal-itself/890597&lt;/li&gt;
  &lt;li&gt;https://www.shellscript.sh/&lt;/li&gt;
  &lt;li&gt;https://www.win.tue.nl/~aeb/linux/lk/lk-5.html&lt;/li&gt;
  &lt;li&gt;https://lasr.cs.ucla.edu/vahab/resources/signals.html&lt;/li&gt;
  &lt;li&gt;http://www.linuxprogrammingblog.com/all-about-linux-signals?page=show&lt;/li&gt;
  &lt;li&gt;ftp://ftp.gnu.org/old-gnu/Manuals/glibc-2.2.3/html_chapter/libc_24.html&lt;/li&gt;
  &lt;li&gt;http://askubuntu.com/questions/184071/what-is-the-purpose-of-the-9-option-in-the-kill-command&lt;/li&gt;
  &lt;li&gt;https://www.digitalocean.com/community/tutorials/how-to-use-ps-kill-and-nice-to-manage-processes-in-linux&lt;/li&gt;
  &lt;li&gt;https://s905060.gitbooks.io/site-reliability-engineer-handbook/content/signals.html&lt;/li&gt;
  &lt;li&gt;http://bencane.com/2014/04/01/understanding-the-kill-command-and-how-to-terminate-processes-in-linux/&lt;/li&gt;
  &lt;li&gt;https://major.io/2010/03/18/sigterm-vs-sigkill/&lt;/li&gt;
&lt;/ol&gt;

</description>
        <pubDate>Wed, 15 Aug 2018 00:00:00 +0700</pubDate>
        <link>https://llnx.me/technical/2018/08/15/Signal-of-linux.html</link>
        <guid isPermaLink="true">https://llnx.me/technical/2018/08/15/Signal-of-linux.html</guid>
        
        
        <category>technical</category>
        
      </item>
    
      <item>
        <title>Learning logs in Aug</title>
        <description>&lt;ol&gt;
  &lt;li&gt;Export large tables in MySQL&lt;/li&gt;
  &lt;li&gt;Bash completion on debian 9&lt;/li&gt;
&lt;/ol&gt;

&lt;!--description--&gt;

&lt;h3 id=&quot;1-export-large-tables-in-mysql&quot;&gt;1. Export large tables in MySQL&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Large tables&lt;/li&gt;
  &lt;li&gt;Progress&lt;/li&gt;
  &lt;li&gt;Compression&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tmux new -s exporting
mysqldump -udevops -pxxxxxx -hhost.xxxx \
           dbname table1 table2 table3 | pv | gzip -9 &amp;gt; 3tables.sql.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;2-bash-completion-on-debian-9&quot;&gt;2. Bash completion on debian 9&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Autocomplete / hint when pressing tab&lt;/li&gt;
  &lt;li&gt;Apply for all user/profile&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apt install bash-completion

# In file /etc/profile
if [ -f /etc/bash_completion ]; then
 . /etc/bash_completion
fi
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/a/21091197/5402121&quot;&gt;https://stackoverflow.com/a/21091197/5402121&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://packages.debian.org/stretch/bash-completion&quot;&gt;https://packages.debian.org/stretch/bash-completion&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Mon, 06 Aug 2018 00:00:00 +0700</pubDate>
        <link>https://llnx.me/today-i-learned/2018/08/06/Learning-logs-in-Aug.html</link>
        <guid isPermaLink="true">https://llnx.me/today-i-learned/2018/08/06/Learning-logs-in-Aug.html</guid>
        
        
        <category>today-i-learned</category>
        
      </item>
    
      <item>
        <title>RDS as-a-fckin-service</title>
        <description>&lt;p&gt;&lt;strong&gt;AWS RDS document&lt;/strong&gt;: 
Depending on the DB instance class and the amount of storage, it can take up to 20 minutes before the new instance is available.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Reality&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;RDB instance status: creating&lt;/li&gt;
  &lt;li&gt;RDS stuck in this fucking step nearly 2 hours and couting&lt;/li&gt;
  &lt;li&gt;db-fuck-as-a-service&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/rds.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;!--description--&gt;

&lt;h3 id=&quot;i-guest-aka-initiation-step-by-step&quot;&gt;I guest aka initiation step-by-step&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Somehow the init RDB button will trigger a form with all specs, then send sms directly to a fucking devops guy of AWS ;)))&lt;/li&gt;
  &lt;li&gt;Then that guy will goto AWS console, init new EC2 manually by his hand, use &lt;code class=&quot;highlighter-rouge&quot;&gt;rds-fucking-root.pem&lt;/code&gt; keypairs&lt;/li&gt;
  &lt;li&gt;YEAH, then then then pick &lt;code class=&quot;highlighter-rouge&quot;&gt;ansible-playbook&lt;/code&gt; from somewhere in the internet then run this fuck&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;AND NOW: we have super-HA-scalable-db-as-a-service behind RDS term&lt;/p&gt;

&lt;p&gt;Fact (trustme): nslookup of RDS domain, it will result EC2 domains&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_GettingStarted.CreatingConnecting.MySQL.html&quot;&gt;https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_GettingStarted.CreatingConnecting.MySQL.html&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 24 Jul 2018 00:00:00 +0700</pubDate>
        <link>https://llnx.me/technical/2018/07/24/RDS-as-a-fckin-service.html</link>
        <guid isPermaLink="true">https://llnx.me/technical/2018/07/24/RDS-as-a-fckin-service.html</guid>
        
        
        <category>technical</category>
        
      </item>
    
      <item>
        <title>Mindset for building HA and scalable system</title>
        <description>&lt;p&gt;&lt;strong&gt;System or infrastructure must have&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Fault tolerance&lt;/li&gt;
  &lt;li&gt;No single point of failure&lt;/li&gt;
  &lt;li&gt;More than one or two security layers&lt;/li&gt;
  &lt;li&gt;Auto-failover without requiring human intervention&lt;/li&gt;
  &lt;li&gt;Heartbeat monitoring on all running components&lt;/li&gt;
  &lt;li&gt;Infrastructure as code&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/port-k8s.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;!--description--&gt;

&lt;h3 id=&quot;fault-tolerance&quot;&gt;Fault tolerance&lt;/h3&gt;
&lt;p&gt;It is the property that enables a system to &lt;strong&gt;continue operating&lt;/strong&gt; properly in the event of the &lt;strong&gt;failure&lt;/strong&gt; of (or one or more faults within) some of its &lt;strong&gt;components&lt;/strong&gt;. If its operating quality decreases at all, the decrease is proportional to the severity of the failure, as compared to a naively designed system in which even a small failure can cause total breakdown. Fault tolerance is particularly sought after in high-availability or life-critical systems.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Distributed read/write to MySQL replication cluster&lt;/li&gt;
  &lt;li&gt;CDN system like Cloudfront/Cloudflare&lt;/li&gt;
  &lt;li&gt;Micro-services, seperated databases for some big components&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;single-point-of-failure&quot;&gt;Single point of failure&lt;/h3&gt;
&lt;p&gt;A single point of failure (SPOF) is a &lt;strong&gt;part of a system&lt;/strong&gt; that, &lt;strong&gt;if it fails&lt;/strong&gt;, will &lt;strong&gt;stop the entire system&lt;/strong&gt; from working. SPOFs are undesirable in any system with a goal of high availability or reliability, be it a business practice, software application, or other industrial system.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;MySQL multi-master - galera cluster&lt;/li&gt;
  &lt;li&gt;AWS RDS multi-AZ feature&lt;/li&gt;
  &lt;li&gt;Elasticsearch master nodes&lt;/li&gt;
  &lt;li&gt;Redis sentinel&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;defense-in-depth&quot;&gt;Defense in depth&lt;/h3&gt;
&lt;p&gt;Defense in depth (also known as Castle Approach) is an information assurance (IA) concept in which &lt;strong&gt;multiple layers of security controls&lt;/strong&gt; (defense) are placed throughout an information technology (IT) system. Its intent is to provide redundancy in the event a security control fails or a vulnerability is exploited that can cover aspects of personnel, procedural, technical and physical for the duration of the system’s life cycle.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Cloudflare Anti DDOS layer&lt;/li&gt;
  &lt;li&gt;IPtable / AWS secgroup&lt;/li&gt;
  &lt;li&gt;VPN&lt;/li&gt;
  &lt;li&gt;Snort / Ossec&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;failover&quot;&gt;Failover&lt;/h3&gt;
&lt;p&gt;A method of protecting computer systems from failure, in which &lt;strong&gt;standby equipment automatically takes over when the main system fails&lt;/strong&gt;. In computing, failover is switching to a redundant or standby computer server, system, hardware component or network upon the failure or abnormal termination of the previously active application, server, system, hardware component, or network. Failover and switchover are essentially the same operation, except that failover is automatic and usually operates without warning, while &lt;strong&gt;switchover requires human intervention&lt;/strong&gt;.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;HAproxy / AWS ALB &amp;amp; ELB&lt;/li&gt;
  &lt;li&gt;Auto promote on MySQL replication&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;heartbeat&quot;&gt;Heartbeat&lt;/h3&gt;
&lt;p&gt;In computer science, a heartbeat is a &lt;strong&gt;periodic signal&lt;/strong&gt; generated by hardware or software to &lt;strong&gt;indicate normal operation or to synchronize&lt;/strong&gt; other parts of a computer system. Usually a heartbeat is &lt;strong&gt;sent between machines&lt;/strong&gt; at a regular interval in the order of seconds. If the endpoint does &lt;strong&gt;not receive a heartbeat&lt;/strong&gt; for a time —usually a few heartbeat intervals—, the machine that should have sent the heartbeat is &lt;strong&gt;assumed to have failed&lt;/strong&gt;.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Uptime tools (Monit, Newrelic synthetics, AWS LB healh-check)&lt;/li&gt;
  &lt;li&gt;Percona pt-heartbeat&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;infrastructure-as-code&quot;&gt;Infrastructure as code&lt;/h3&gt;
&lt;p&gt;All configuration is defined in executable configuration definition files, such as shell scripts, Ansible playbooks, Chef recipes, or Puppet manifests …&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Infra &amp;amp; network layer: Terraform, Cloudformation&lt;/li&gt;
  &lt;li&gt;Application layer: Ansible playbook, Puppet, Chef, Salt stack&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Fault_tolerance&quot;&gt;https://en.wikipedia.org/wiki/Fault_tolerance&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Single_point_of_failure&quot;&gt;https://en.wikipedia.org/wiki/Single_point_of_failure&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Defense_in_depth_(computing)&quot;&gt;https://en.wikipedia.org/wiki/Defense_in_depth_(computing)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Failover&quot;&gt;https://en.wikipedia.org/wiki/Failover&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Infrastructure_as_Code&quot;&gt;https://en.wikipedia.org/wiki/Infrastructure_as_Code&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Wed, 18 Jul 2018 00:00:00 +0700</pubDate>
        <link>https://llnx.me/technical/2018/07/18/Mindset-for-building-HA-system.html</link>
        <guid isPermaLink="true">https://llnx.me/technical/2018/07/18/Mindset-for-building-HA-system.html</guid>
        
        
        <category>technical</category>
        
      </item>
    
      <item>
        <title>Increase EBS volume of AWS on linux</title>
        <description>&lt;h2 id=&quot;problem&quot;&gt;Problem&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;A disk volume 32GB &lt;code class=&quot;highlighter-rouge&quot;&gt;/dev/xvdf1&lt;/code&gt; is mounted into &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/lib/mysql&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;This volume is out of space, need to be extend size to 64GB&lt;/li&gt;
  &lt;li&gt;Extended to 64GB on aws console, but from ec2 point of view, it’s just 32GB&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Rootcause&lt;/code&gt;&lt;/strong&gt;: didn’t merge partition after extending and resize fs&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/ebs-aws.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;!--description--&gt;

&lt;h2 id=&quot;solution&quot;&gt;Solution&lt;/h2&gt;

&lt;p&gt;Resize file system to larger size of this volume&lt;/p&gt;

&lt;h3 id=&quot;step1-collect-information&quot;&gt;Step1: Collect information&lt;/h3&gt;

&lt;p&gt;Check disk ID&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@webapp-unstable:~# blkid
/dev/xvda1: LABEL=&quot;cloudimg-rootfs&quot; UUID=&quot;4573eb39-57f3-439b-9a73-8aef508afd3f&quot; TYPE=&quot;ext4&quot; PARTUUID=&quot;965243d6-01&quot;
/dev/xvdf1: UUID=&quot;d56d3b3e-4385-48a7-ba95-6d3884d5dca8&quot; TYPE=&quot;ext4&quot; PARTUUID=&quot;cc52698e-01&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Check size disk and mount point of &lt;code class=&quot;highlighter-rouge&quot;&gt;/dev/xvdf1&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@webapp-unstable:~# lsblk
NAME    MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
xvda    202:0    0  16G  0 disk
└─xvda1 202:1    0  16G  0 part /
xvdf    202:80   0  64G  0 disk
└─xvdf1 202:81   0  32G  0 part /var/lib/mysql
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;step-2-unmount-this-volume-out-of-system&quot;&gt;Step 2: Unmount this volume out of system&lt;/h3&gt;

&lt;p&gt;Unmount&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@webapp-unstable:~# umount /dev/xvdf1
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Check after unmount&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@webapp-unstable:~# lsblk
NAME    MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
xvda    202:0    0  16G  0 disk
└─xvda1 202:1    0  16G  0 part /
xvdf    202:80   0  64G  0 disk
└─xvdf1 202:81   0  32G  0 part
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;step-3-delete-and-recreate-new-partition&quot;&gt;Step 3: Delete and recreate new partition&lt;/h3&gt;

&lt;p&gt;Why? Because old partition is using 32GB only, should delete and re-create new one. After that, the new one will use all of space 64GB&lt;/p&gt;

&lt;p&gt;Using &lt;code class=&quot;highlighter-rouge&quot;&gt;fdisk&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;parted/gparted&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@webapp-unstable:~# fdisk /dev/xvdf

Welcome to fdisk (util-linux 2.27.1).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.


Command (m for help): p
Disk /dev/xvdf: 64 GiB, 68719476736 bytes, 134217728 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xcc52698e

Device     Boot Start      End  Sectors Size Id Type
/dev/xvdf1       2048 67108863 67106816  32G 83 Linux

Command (m for help): d
Selected partition 1
Partition 1 has been deleted.

Command (m for help): n
Partition type
   p   primary (0 primary, 0 extended, 4 free)
   e   extended (container for logical partitions)
Select (default p): p
Partition number (1-4, default 1):
First sector (2048-134217727, default 2048):
Last sector, +sectors or +size{K,M,G,T,P} (2048-134217727, default 134217727):

Created a new partition 1 of type 'Linux' and of size 64 GiB.

Command (m for help): p
Disk /dev/xvdf: 64 GiB, 68719476736 bytes, 134217728 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xcc52698e

Device     Boot Start       End   Sectors Size Id Type
/dev/xvdf1       2048 134217727 134215680  64G 83 Linux

Command (m for help): w
The partition table has been altered.
Calling ioctl() to re-read partition table.
Syncing disks.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;step-4-resize-file-system-of-this-volume&quot;&gt;Step 4: Resize file system of this volume&lt;/h3&gt;

&lt;p&gt;Using &lt;code class=&quot;highlighter-rouge&quot;&gt;resize2fs&lt;/code&gt; because this volume is &lt;code class=&quot;highlighter-rouge&quot;&gt;ext4&lt;/code&gt; format&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@webapp-unstable:~# resize2fs /dev/xvdf1
resize2fs 1.42.13 (17-May-2015)
Filesystem at /dev/xvdf1 is mounted on /var/lib/mysql; on-line resizing required
old_desc_blocks = 2, new_desc_blocks = 4
The filesystem on /dev/xvdf1 is now 16776960 (4k) blocks long.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Check after resizing&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@webapp-unstable:~# lsblk
NAME    MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
xvda    202:0    0  16G  0 disk
└─xvda1 202:1    0  16G  0 part /
xvdf    202:80   0  64G  0 disk
└─xvdf1 202:81   0  64G  0 part /var/lib/mysql
root@webapp-unstable:~# df -h
Filesystem      Size  Used Avail Use% Mounted on
udev            2.0G     0  2.0G   0% /dev
tmpfs           396M   41M  355M  11% /run
/dev/xvda1       16G  6.9G  8.6G  45% /
tmpfs           2.0G     0  2.0G   0% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
tmpfs           2.0G     0  2.0G   0% /sys/fs/cgroup
tmpfs           396M     0  396M   0% /run/user/1000
/dev/xvdf1       63G   30G   31G  50% /var/lib/mysql

root@webapp-unstable:~# mount -fav
/                        : ignored
/var/lib/mysql           : already mounted
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;DONE.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/recognize-expanded-volume-linux.html&quot;&gt;http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/recognize-expanded-volume-linux.html&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 14 Dec 2017 00:00:00 +0700</pubDate>
        <link>https://llnx.me/technical/2017/12/14/Increase-EBS-volume.html</link>
        <guid isPermaLink="true">https://llnx.me/technical/2017/12/14/Increase-EBS-volume.html</guid>
        
        
        <category>technical</category>
        
      </item>
    
      <item>
        <title>Understanding top command</title>
        <description>&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;#understanding-top-command&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;top&lt;/code&gt;&lt;/a&gt;&lt;/strong&gt; is a monitoring program which is used frequently for tracking process’s resource usage and its activity in &lt;strong&gt;real-time&lt;/strong&gt;, show current tasks being serviced by the kernel, help &lt;strong&gt;discovering&lt;/strong&gt; and &lt;strong&gt;diagnosing&lt;/strong&gt; overload or capacity of system by seeing &lt;strong&gt;CPU &amp;amp; Mem usage&lt;/strong&gt;. It’s available under many Unix/Linux operating systems.&lt;/p&gt;

&lt;p&gt;Keyword: &lt;a href=&quot;/technical/2017/07/16/Understanding-top-command.html#understanding-top-command&quot;&gt;top&lt;/a&gt;, 
         &lt;a href=&quot;/technical/2017/07/16/Understanding-top-command.html#1-date-and-uptime&quot;&gt;uptime&lt;/a&gt;, 
         &lt;a href=&quot;/technical/2017/07/16/Understanding-top-command.html#2-number-of-logged-users&quot;&gt;users&lt;/a&gt;, 
         &lt;a href=&quot;/technical/2017/07/16/Understanding-top-command.html#3-load-average&quot;&gt;load average&lt;/a&gt;,
         &lt;a href=&quot;/technical/2017/07/16/Understanding-top-command.html#4-processthread-state&quot;&gt;process/thread state&lt;/a&gt;,
         &lt;a href=&quot;/technical/2017/07/16/Understanding-top-command.html#5-cpu-organization-and-operation&quot;&gt;CPU operation&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/top-command-optimized.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;!--description--&gt;

&lt;h2 id=&quot;description-from-man-page&quot;&gt;Description from man page:&lt;/h2&gt;
&lt;p&gt;The top program provides a dynamic real-time view of a running system. It can display system summary information as well as a list of processes or threads currently being managed by the Linux kernel. The types of system summary information shown and the types order and size of information displayed for processes are all user configurable and that configuration can be  made persistent across restarts.&lt;/p&gt;

&lt;p&gt;The program provides a limited interactive interface for process manipulation as well as a much more extensive interface for personal configuration - encompassing every aspect of its operation. And while top is referred to throughout this document, you are free to name the program anything you wish. That new name, possibly an alias, will then be reflected on top’s display and used when reading and writing a configuration file. …&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;❯❯ Need more?&lt;/strong&gt; See &lt;a href=&quot;http://man7.org/linux/man-pages/man1/top.1.html&quot;&gt;http://man7.org/linux/man-pages/man1/top.1.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But it’s too fucking long 💢 and want to see the whole picture? 🌟 Sure, I have a picture below&lt;/p&gt;

&lt;h2 id=&quot;understanding-top-command&quot;&gt;Understanding top command&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/top-command.png&quot; alt=&quot;large-img&quot; title=&quot;Top command explaination&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;1-date-and-uptime&quot;&gt;1. Date and uptime&lt;/h3&gt;
&lt;p&gt;Current time is &lt;strong&gt;13:41&lt;/strong&gt;, and system has been running for over &lt;strong&gt;5 weeks&lt;/strong&gt;, from last boot on &lt;strong&gt;May 17&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;top - 13:41:31 up 38 days, 21:04,  3 users,  load average: 0.01, 0.09, 0.13
❯❯ date
Sun Jun 25 13:41:31 UTC 2017
❯❯ uptime
13:41:31 up 38 days, 21:04,  3 users,  load average: 0.01, 0.09, 0.13
❯❯ uptime -p
up 5 weeks, 3 days, 21 hours, 6 minutes
❯❯ uptime -s
2017-05-17 16:37:26
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;2-number-of-logged-users&quot;&gt;2. Number of logged users&lt;/h3&gt;
&lt;p&gt;I have 3 logged users and what they are doing:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;one is running ssh to other&lt;/li&gt;
  &lt;li&gt;one is on bash shell&lt;/li&gt;
  &lt;li&gt;and … me with &lt;code class=&quot;highlighter-rouge&quot;&gt;w&lt;/code&gt; command&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;3 users
❯❯ w
 13:41:31 up 38 days, 21:04,  3 users,  load average: 0.00, 0.01, 0.05
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
ubuntu   pts/0    x.205.x.xxx      13:09    1:34   0.07s  0.03s ssh abc.xyz
ubuntu   pts/3    x.64.xx.xxx      05:11    8:36m  0.05s  0.01s -bash
ubuntu   pts/6    x.161.x.xxx      13:47    3.00s  0.04s  0.00s w
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;3-load-average&quot;&gt;3. Load average&lt;/h3&gt;
&lt;p&gt;The &lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;load average&lt;/code&gt;&lt;/strong&gt; is a number corresponding to the average number of &lt;strong&gt;runnable processes&lt;/strong&gt; on the system. The load average is often listed as three sets of numbers, which represent the load average for the past 1, 5, and 15 minutes. - from &lt;a href=&quot;https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/4/html/Introduction_To_System_Administration/s2-bandwidth-rhlspec-cpu.html&quot;&gt;RedHat&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;On Linux systems, these numbers include &lt;strong&gt;processes wanting to run on CPU&lt;/strong&gt;, as well as processes blocked in uninterruptible I/O (usually disk I/O). This gives a high level idea of &lt;strong&gt;resource load&lt;/strong&gt; (or demand). The three numbers give us some idea of &lt;strong&gt;how load is changing over time&lt;/strong&gt;. For example, if you’ve been asked to check a problem server, and the 1 minute value is much lower than the 15 minute value, then you might have logged in too late and missed the issue - from &lt;a href=&quot;https://medium.com/netflix-techblog/linux-performance-analysis-in-60-000-milliseconds-accc10403c55&quot;&gt;Netfilx Techblog&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Runable processes&lt;/code&gt;&lt;/strong&gt; means: running and blocked processes (usually by I/O). That’s really important because it means that you can have &lt;code class=&quot;highlighter-rouge&quot;&gt;0% CPU usage&lt;/code&gt; and still have &lt;code class=&quot;highlighter-rouge&quot;&gt;high load&lt;/code&gt;. The processes blocked on I/O show up in the “&lt;strong&gt;D&lt;/strong&gt;” state in &lt;code class=&quot;highlighter-rouge&quot;&gt;ps&lt;/code&gt;, header “STAT” or “S”&lt;/p&gt;

&lt;p&gt;Lower numbers are better than higher numbers. If the third number is &lt;strong&gt;too high&lt;/strong&gt; (15 minutes ago), I think we got a problem about the performance to deal with. But what’s the &lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Threshold&lt;/code&gt;&lt;/strong&gt;, what’s too high. We need a reasonable and &lt;strong&gt;acceptable value&lt;/strong&gt; for comparison.&lt;/p&gt;

&lt;h4 id=&quot;31-single-logical-cpu&quot;&gt;3.1 Single logical CPU&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;In general&lt;/strong&gt;, with &lt;code class=&quot;highlighter-rouge&quot;&gt;one logical CPU&lt;/code&gt; - 1 vCPU, &lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Threshold = 0.7&lt;/code&gt;&lt;/strong&gt; is a best practice, many sysadmins will draw a line at 0.70.&lt;/p&gt;

&lt;p&gt;For example in case of 1 vCPU:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;load average: 1.25, 0.60, 4.20
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;over the last 1 minute: System was overloaded by &lt;code class=&quot;highlighter-rouge&quot;&gt;25% on average&lt;/code&gt;. 0.25 processes were waiting for the CPU&lt;/li&gt;
  &lt;li&gt;over the last 5 minutes: CPU &lt;code class=&quot;highlighter-rouge&quot;&gt;idled for 40%&lt;/code&gt; of the time. &lt;strong&gt;It’s acceptable&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;over the last 15 minutes: System was &lt;code class=&quot;highlighter-rouge&quot;&gt;overloaded by 320%&lt;/code&gt; on average. 3.20 processes were waiting for the CPU.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;32--multi-logical-cpus&quot;&gt;3.2  Multi-logical CPUs&lt;/h4&gt;
&lt;p&gt;With 4 logical CPUs system? It’s still healthy with a load of 2.80 - 3.00. On multi-logical CPUs system, the load is relative to the number of vCPUs available.&lt;/p&gt;

&lt;p&gt;The “100% utilization” mark is 1.00 on a single-logical CPU system, 2.00, on a dual vCPUs, 4.00 on a quad-vCPUs, etc.&lt;/p&gt;

&lt;p&gt;In &lt;code class=&quot;highlighter-rouge&quot;&gt;top&lt;/code&gt; command, press &lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt; for each vCPU is displayed seperately, also to know number of vCPU.
I have 4 vCPUs in this case, using EC2 AWS C4 type, low load average&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;top - 09:10:00 up 32 days, 6 min,  2 users,  load average: 0.01, 0.04, 0.05
Tasks: 125 total,   1 running, 124 sleeping,   0 stopped,   0 zombie
%Cpu0  :  0.7 us,  0.0 sy,  0.0 ni, 99.3 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
%Cpu1  :  0.0 us,  0.3 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
%Cpu2  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
%Cpu3  :  5.0 us,  0.3 sy,  0.0 ni, 94.6 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Something more:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;💢 &lt;strong&gt;Confusing&lt;/strong&gt; about vCPUs/cores/threads - See &lt;a href=&quot;https://github.com/hieuhtr/Blog/issues/55&quot;&gt;CPU Architecture fundamental&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;🌟 For &lt;strong&gt;deep understanding&lt;/strong&gt; about load average - See &lt;a href=&quot;http://blog.scoutapp.com/articles/2009/07/31/understanding-load-averages&quot;&gt;this post&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;🌟 For another example - See &lt;a href=&quot;https://en.wikipedia.org/wiki/Load_%28computing%29#Unix-style_load_calculation&quot;&gt;wiki&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;🌟 Case: High load average but low CPU ultilization - See &lt;a href=&quot;https://www.pitt-pladdy.com/blog/_20150829-125708_0100_Linux_performance_metric_myths_Load_Average_IO_Wait_/&quot;&gt;this post&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;4-processthread-state&quot;&gt;4. Process/Thread state&lt;/h3&gt;
&lt;p&gt;Let’s focus on &lt;strong&gt;Area1&lt;/strong&gt; in that &lt;a href=&quot;/technical/2017/07/16/Understanding-top-command.html#understanding-top-command&quot;&gt;overview picture&lt;/a&gt; above. In that top area, &lt;code class=&quot;highlighter-rouge&quot;&gt;top&lt;/code&gt; shows the total number of processes and how many of them are running. But it says &lt;strong&gt;Tasks&lt;/strong&gt; not &lt;strong&gt;Processes&lt;/strong&gt;. Because another name for a process is a task. The Linux kernel internally refers to processes as tasks.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Tasks: 283 total,   1 running, 282 sleeping,   0 stopped,   0 zombie
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;From the time a process is born to when it is terminated, the process proceeds through various states. Those states can include &lt;strong&gt;Runnable&lt;/strong&gt;, &lt;strong&gt;Running&lt;/strong&gt;, &lt;strong&gt;Sleeping&lt;/strong&gt; (in memory and on disk), and &lt;strong&gt;Zombie&lt;/strong&gt; states - from &lt;a href=&quot;https://access.redhat.com/sites/default/files/attachments/processstates_20120831.pdf&quot;&gt;Redhat&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/process-state.png&quot; alt=&quot;&quot; title=&quot;Process state life cycle&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;41-runable-state&quot;&gt;4.1 Runable state&lt;/h4&gt;
&lt;p&gt;When a process is in a Runnable state, it means it has all the resources it needs to run, except that the CPU
is not available.&lt;/p&gt;

&lt;p&gt;For example: A process is dealing with I/O, so it does not immediately need the CPU,  when the process finishes the I/O operation, a signal is generated to the CPU and the scheduler keeps that process in the run queue (the list of ready-to-run processes maintained by the kernel) - &lt;strong&gt;Runable&lt;/strong&gt;. When the CPU is available, this process will enter into &lt;strong&gt;Running&lt;/strong&gt; state&lt;/p&gt;

&lt;h4 id=&quot;42-running-state&quot;&gt;4.2 Running state&lt;/h4&gt;
&lt;p&gt;The process that is executing and using the CPU at a particular moment is called a &lt;strong&gt;Running&lt;/strong&gt; process.&lt;/p&gt;

&lt;p&gt;A CPU can execute either in kernel mode (sy) or in user mode (us). When a user initiates a process, the process starts working in user mode. That user mode process does not have access to kernel data structures or algorithms. Each CPU type provides special instructions to switch from user mode to kernel mode - they’re &lt;strong&gt;system calls&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;System calls&lt;/strong&gt;: communication chanel between user space program and kernel&lt;/p&gt;

&lt;h4 id=&quot;43-sleeping-state&quot;&gt;4.3 Sleeping state&lt;/h4&gt;
&lt;p&gt;A process enters a &lt;strong&gt;Sleeping&lt;/strong&gt; state when it needs resources that are not currently available. At that point, it either goes voluntarily into Sleep state or the kernel puts it into Sleep state. Going into Sleep state means the process immediately gives up its access to the CPU.&lt;/p&gt;

&lt;p&gt;When the resource the process is waiting on becomes available, a signal is sent to the CPU. The next time the scheduler gets a chance to schedule this sleeping process, the scheduler will put the process either in Running or Runnable state&lt;/p&gt;

&lt;h4 id=&quot;44-terminatedstopped-state&quot;&gt;4.4 Terminated/Stopped state&lt;/h4&gt;
&lt;p&gt;Processes can end when they call the exit system themselves or receive signals to end. We use &lt;code class=&quot;highlighter-rouge&quot;&gt;kill -9 &amp;lt;PID&amp;gt;&lt;/code&gt; to kill a process.&lt;/p&gt;

&lt;p&gt;See more at &lt;a href=&quot;https://github.com/hieuhtr/Blog/blob/master/2017/Signal-of-Linux.md&quot;&gt;Signals&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;45-zombie-state&quot;&gt;4.5 Zombie state&lt;/h4&gt;
&lt;p&gt;When a process dies on Linux, it isn’t all removed from memory immediately — its process descriptor stays in memory (the process descriptor only takes a tiny amount of memory). The process’s status becomes &lt;code class=&quot;highlighter-rouge&quot;&gt;EXIT_ZOMBIE&lt;/code&gt; and the process’s parent is notified that its child process has died with the &lt;code class=&quot;highlighter-rouge&quot;&gt;SIGCHLD&lt;/code&gt; signal. The parent process is then supposed to execute the &lt;code class=&quot;highlighter-rouge&quot;&gt;wait()&lt;/code&gt; system call to read the dead process’s exit status and other information. This allows the parent process to get information from the dead process. After &lt;code class=&quot;highlighter-rouge&quot;&gt;wait()&lt;/code&gt; is called, the zombie process is completely removed from memory.&lt;/p&gt;

&lt;p&gt;This normally happens very quickly, so you won’t see zombie processes accumulating on your system. However, if a parent process isn’t programmed properly and never calls wait(), its zombie children will stick around in memory until they’re cleaned up. - from &lt;a href=&quot;https://www.howtogeek.com/119815/htg-explains-what-is-a-zombie-process-on-linux/&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Zombies that exist for more than a short period of time typically indicate a bug in the parent program, or just an uncommon decision to not reap children (see example). If the parent program is no longer running, zombie processes typically indicate a bug in the operating system. - from &lt;a href=&quot;https://en.wikipedia.org/wiki/Zombie_process&quot;&gt;Wiki&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Here are the different values that the s, stat and state output specifiers (header “STAT” or “S”) will display to describe the state of a process:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;D:    uninterruptible sleep (usually IO)&lt;/li&gt;
  &lt;li&gt;R:    running or runnable (on run queue)&lt;/li&gt;
  &lt;li&gt;S:    interruptible sleep (waiting for an event to complete)&lt;/li&gt;
  &lt;li&gt;T:    stopped by job control signal&lt;/li&gt;
  &lt;li&gt;t:    stopped by debugger during the tracing&lt;/li&gt;
  &lt;li&gt;W:    paging (not valid since the 2.6.xx kernel)&lt;/li&gt;
  &lt;li&gt;X:    dead (should never be seen)&lt;/li&gt;
  &lt;li&gt;Z:    defunct (“zombie”) process, terminated but not reaped by its parent&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;See state of all processes by using &lt;code class=&quot;highlighter-rouge&quot;&gt;ps -el&lt;/code&gt; command.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯❯ ps -el
F S   UID   PID  PPID  C PRI  NI ADDR SZ WCHAN  TTY          TIME CMD
4 S     0     1     0  0  80   0 - 29910 -      ?        00:00:04 systemd
1 S     0     2     0  0  80   0 -     0 -      ?        00:00:00 kthreadd
1 S     0     4     2  0  60 -20 -     0 -      ?        00:00:00 kworker/0:0H
...
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Something more:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Understanding Linux Process States- See &lt;a href=&quot;https://access.redhat.com/sites/default/files/attachments/processstates_20120831.pdf&quot;&gt;document from RedHat&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Signals- See &lt;a href=&quot;https://github.com/hieuhtr/Blog/blob/master/2017/Signal-of-Linux.md&quot;&gt;Signals of Linux&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Zombie process - See &lt;a href=&quot;https://en.wikipedia.org/wiki/Zombie_process&quot;&gt;Wiki&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;5-cpu-organization-and-operation&quot;&gt;5. CPU organization and operation&lt;/h3&gt;
</description>
        <pubDate>Sun, 16 Jul 2017 00:00:00 +0700</pubDate>
        <link>https://llnx.me/technical/2017/07/16/Understanding-top-command.html</link>
        <guid isPermaLink="true">https://llnx.me/technical/2017/07/16/Understanding-top-command.html</guid>
        
        
        <category>technical</category>
        
      </item>
    
      <item>
        <title>Adware on Betternet chrome extension</title>
        <description>&lt;p&gt;Sometime when clicking to any urls on internet, chrome redirects to ads sites like &lt;a href=&quot;http://eltrack.pro/azkzkyvodi&quot;&gt;http://eltrack.pro/azkzkyvodi&lt;/a&gt; or something like this. Also see &lt;code class=&quot;highlighter-rouge&quot;&gt;pornographic ads&lt;/code&gt; on new tab&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Mac OS Sierra 10.12.5 (16F73)&lt;/li&gt;
  &lt;li&gt;Chrome Version 59.0.3071.109 (Official Build) (64-bit)&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;TL;DR: Remove Betternet out of chrome&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/betternet-adware-links.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;!--description--&gt;

&lt;h2 id=&quot;steps-to-debug-and-figure-out-adware&quot;&gt;Steps to debug and figure out adware&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Step 1.&lt;/strong&gt; Hold ads site on tab, don’t close it because it’s hard to find logs later&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Step 2.&lt;/strong&gt; Open &lt;strong&gt;Chrome DevTools&lt;/strong&gt;, go to &lt;code class=&quot;highlighter-rouge&quot;&gt;console&lt;/code&gt; tab&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Step 3.&lt;/strong&gt; I saw chrome has some unknown logs from &lt;code class=&quot;highlighter-rouge&quot;&gt;insertion.js:189&lt;/code&gt;, comes from extension with ID = &lt;code class=&quot;highlighter-rouge&quot;&gt;gjknjjomckknofjidppipffbpoekiipm&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/betternet-adware-logs.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Step 4.&lt;/strong&gt; Goto &lt;a href=&quot;chrome://extensions/&quot;&gt;chrome://extensions/&lt;/a&gt; and find &lt;code class=&quot;highlighter-rouge&quot;&gt;gjknjjomckknofjidppipffbpoekiipm&lt;/code&gt;, it’s &lt;strong&gt;betternet&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Step 5.&lt;/strong&gt; Figure out more, google search with term “betternet extension adware”, here is best write-up about this &lt;a href=&quot;https://restoreprivacy.com/betternet-review/&quot;&gt;https://restoreprivacy.com/betternet-review/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/betternet-adware.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Step 6.&lt;/strong&gt; Expand source of &lt;a href=&quot;http://eltrack.pro&quot;&gt;http://eltrack.pro&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;My browser is redirected/injected to a fucking FB campaign, &lt;strong&gt;Pixel ID&lt;/strong&gt; = &lt;code class=&quot;highlighter-rouge&quot;&gt;1666009176948198&lt;/code&gt;&lt;/p&gt;

    &lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Facebook Pixel Code --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fbq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fbq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;arguments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;queue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;arguments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_fbq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_fbq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loaded&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=!&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2.0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;queue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;async&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=!&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementsByTagName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parentNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;insertBefore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'script'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'https://connect.facebook.net/en_US/fbevents.js'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;fbq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'init'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'1666009176948198'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Insert your pixel ID here.&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;fbq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'track'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'PageView'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;noscript&amp;gt;&amp;lt;img&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;style=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;display:none&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://www.facebook.com/tr?id=1666009176948198&amp;amp;ev=PageView&amp;amp;noscript=1&quot;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&amp;lt;/noscript&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- DO NOT MODIFY --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- End Facebook Pixel Code --&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;This url &lt;code class=&quot;highlighter-rouge&quot;&gt;tintuc-vn.com&lt;/code&gt; in source of ads site&lt;/p&gt;

    &lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;err&quot;&gt;❯❯&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nslookup&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tintuc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;		&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;	&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;53&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;Non&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;authoritative&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;answer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;tintuc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;136&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;243&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;94&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;239&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;whois this domain: &lt;a href=&quot;https://whois.icann.org/en/lookup?name=tintuc-vn.com&quot;&gt;https://whois.icann.org/en/lookup?name=tintuc-vn.com&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;which ports are opened?&lt;/p&gt;

    &lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;err&quot;&gt;❯❯&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nmap&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;136&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;243&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;94&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;239&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;Starting&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Nmap&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nmap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;org&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;at&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;06&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;58&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;07&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Nmap&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scan&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;report&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;239&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;94&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;243&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;136&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;your&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;de&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;136&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;243&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;94&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;239&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;Host&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;53&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;latency&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;Not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;987&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;closed&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ports&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;PORT&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;STATE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SERVICE&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;ftp&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;ssh&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;smtp&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;53&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;domain&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;http&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;106&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;pop3pw&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;110&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;pop3&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;143&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;imap&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;443&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;465&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;smtps&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;993&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;imaps&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;995&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;pop3s&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;8443&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tcp&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;open&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;Nmap&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IP&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;host&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scanned&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;what-should-i-do&quot;&gt;What should I do?&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Remove this Betternet chrome extension&lt;/li&gt;
  &lt;li&gt;Report to google&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Sun, 25 Jun 2017 00:00:00 +0700</pubDate>
        <link>https://llnx.me/technical/2017/06/25/Adware-on-Betternet-chrome-extension.html</link>
        <guid isPermaLink="true">https://llnx.me/technical/2017/06/25/Adware-on-Betternet-chrome-extension.html</guid>
        
        
        <category>technical</category>
        
      </item>
    
      <item>
        <title>The MySQL binary log</title>
        <description>&lt;p&gt;&lt;strong&gt;The binary log&lt;/strong&gt; contains &lt;code class=&quot;highlighter-rouge&quot;&gt;events&lt;/code&gt; that describe &lt;code class=&quot;highlighter-rouge&quot;&gt;database changes&lt;/code&gt; such as table creation operations or changes to table data. It also contains events for statements that &lt;strong&gt;potentially could have made changes&lt;/strong&gt; (for example, a DELETE which matched no rows), unless row-based logging is used. The binary log also contains information about &lt;code class=&quot;highlighter-rouge&quot;&gt;how long each statement&lt;/code&gt; took that &lt;strong&gt;updated data&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/master-binlog.png&quot; alt=&quot;Binlog&quot; /&gt;&lt;/p&gt;

&lt;!--description--&gt;

&lt;h2 id=&quot;the-binary-log-has-two-important-purposes&quot;&gt;The binary log has two important purposes:&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;For replication, the binary log on a master replication server provides a record of the data changes to be sent to slave servers.
The master server sends the events contained in its binary log to its slaves, 
which &lt;code class=&quot;highlighter-rouge&quot;&gt;execute&lt;/code&gt; those events to make the &lt;code class=&quot;highlighter-rouge&quot;&gt;same data changes&lt;/code&gt; that were made on the master&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Certain &lt;code class=&quot;highlighter-rouge&quot;&gt;data recovery operations&lt;/code&gt; require use of the binary log. After a backup has been restored, 
the events in the binary log that were recorded after the backup was made are re-executed.
These events bring databases up to date from the point of the backup&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;The binary log is &lt;code class=&quot;highlighter-rouge&quot;&gt;not used&lt;/code&gt; for statements such as &lt;code class=&quot;highlighter-rouge&quot;&gt;SELECT&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;SHOW&lt;/code&gt; that do &lt;code class=&quot;highlighter-rouge&quot;&gt;not modify data&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;To log all statements (for example, to identify a problem query), use the &lt;code class=&quot;highlighter-rouge&quot;&gt;general query log&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Running a server with binary logging enabled makes performance slightly slower.&lt;/li&gt;
  &lt;li&gt;However, the benefits of the binary log in enabling you to set up replication and for restore operations generally outweigh this minor performance decrement.&lt;/li&gt;
  &lt;li&gt;The binary log is generally resilient to unexpected halts because only complete transactions are logged or read back&lt;/li&gt;
  &lt;li&gt;Slave server in replication  by default does not write to its own binary log any data modifications that are received from the replication master. 
But sometime we want to log these modifications, slave can do that. This is done when a slave is also to &lt;code class=&quot;highlighter-rouge&quot;&gt;act as a master&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;other slaves&lt;/code&gt; in chained replication.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;binary-log-files&quot;&gt;Binary log files&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;mysqld&lt;/strong&gt; appends a numeric extension to the binary log base name to generate binlog file names.
The number increases each time the server creates a new log file, thus creating an ordered series of files.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The server creates a &lt;strong&gt;new file&lt;/strong&gt; in the series each time it &lt;strong&gt;starts or flushes&lt;/strong&gt; the logs. 
The server also creates a new binary log file automatically after the current log’s size reaches &lt;code class=&quot;highlighter-rouge&quot;&gt;max_binlog_size&lt;/code&gt;. 
A binary log file may become larger than max_binlog_size if you are using large transactions because a transaction is written to the file in one piece, never split between files.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;To keep track of which binary log files have been used, mysqld also creates a &lt;strong&gt;binary log index file&lt;/strong&gt; that contains the names of all used binary log files. By default, this has the same base name as the binary log file, with the extension &lt;code class=&quot;highlighter-rouge&quot;&gt;.index&lt;/code&gt;. You can change the name of the binary log index file with the &lt;code class=&quot;highlighter-rouge&quot;&gt;--log-bin-index[=file_name]&lt;/code&gt; option. You should not manually edit this file while mysqld is running; doing so would confuse mysqld.&lt;/li&gt;
  &lt;li&gt;A client that has the &lt;strong&gt;SUPER privilege&lt;/strong&gt; can disable binary logging of its own statements by using a &lt;code class=&quot;highlighter-rouge&quot;&gt;SET sql_log_bin=0&lt;/code&gt; statement&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;type-of-binlog&quot;&gt;Type of binlog&lt;/h2&gt;
&lt;p&gt;The format of the events recorded in the binary log is dependent on the binary logging format. The server uses several logging formats to record information in the binary log. &lt;code class=&quot;highlighter-rouge&quot;&gt;Three format&lt;/code&gt; types are supported:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;row-based&lt;/code&gt;: In row-based logging, the &lt;strong&gt;master writes events&lt;/strong&gt; to the binary log that indicate how &lt;strong&gt;individual table rows are affected&lt;/strong&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;statement-based&lt;/code&gt;: Replication capabilities in MySQL originally were based on &lt;strong&gt;propagation of SQL statements&lt;/strong&gt; from master to slave. This is called statement-based logging.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mixed-base&lt;/code&gt;: A third option is also available: mixed logging. With mixed logging, &lt;strong&gt;statement-based logging is used by default&lt;/strong&gt;, but the logging mode &lt;strong&gt;switches automatically to row-based&lt;/strong&gt; in certain cases as described below.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The exact format employed depends on the version of MySQL being used. The logging format can also be set or limited by the storage engine being used. This helps to eliminate issues when replicating certain statements between a master and slave which are using different storage engines&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;
With &lt;code class=&quot;highlighter-rouge&quot;&gt;statement-based&lt;/code&gt; replication, there may be issues with replicating nondeterministic statements. Issue: “Statement may not be safe to log in statement format”. You can avoid these issues by using MySQL’s &lt;code class=&quot;highlighter-rouge&quot;&gt;row-based&lt;/code&gt; replication instead.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;In MySQL &lt;code class=&quot;highlighter-rouge&quot;&gt;row-based&lt;/code&gt; replication&lt;/strong&gt;, each row change event contains two images, a “before” image whose columns are matched against when searching for the row to be updated, and an “after” image containing the changes. Normally, MySQL logs full rows (that is, all columns) for both the before and after images. However, it is not strictly necessary to include every column in both images, and we can often save disk, memory, and network usage by logging only those columns which are actually required.&lt;/p&gt;

&lt;p&gt;In MySQL 5.6, you can cause the server to log full or minimal rows using the &lt;code class=&quot;highlighter-rouge&quot;&gt;binlog_row_image&lt;/code&gt; system variable. This variable actually takes one of three possible values, as shown in the following list:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;full&lt;/code&gt;: Log all columns in both the before image and the after image.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;minimal&lt;/code&gt;: Log only those columns in the before image that are required to identify the row to be changed; log only those columns in the after image that are actually changed.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;noblob&lt;/code&gt;: Log all columns (same as full), except for BLOB and TEXT columns that are not required to identify rows, or that have not changed.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;binlog-operations&quot;&gt;Binlog operations&lt;/h2&gt;
&lt;p&gt;Manual config binlog in this file: &lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/mysql/conf.d/replication-binlog.cnf&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mysqld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;variable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;Enable binary logging and set file base name
    &lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Set index file for binary log file names
    &lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;index&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Config binlog format: &lt;strong&gt;one&lt;/strong&gt; of them
    &lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;binlog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;STATEMENT&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;or&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;binlog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ROW&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;or&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;binlog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MIXED&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;In ROW based, config server to log full or minimal rows
    &lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;binlog_row_image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FULL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Log&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;all&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;binlog_row_image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MINIMAL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Log&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;only&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;changed&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;needed&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;identify&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;binlog_row_image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NOBLOB&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Log&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;all&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unneeded&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLOB&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TEXT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Set number of days for automatic binary log file removal. The default is 0, which means “no automatic removal.”
    &lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;expire&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;days&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Remove binary log files manually
    &lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PURGE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BINARY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LOGS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;or&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;RESET&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MASTER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference:&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://dev.mysql.com/doc/refman/5.6/en/binary-log.html&quot;&gt;https://dev.mysql.com/doc/refman/5.6/en/binary-log.html&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://dev.mysql.com/doc/refman/5.6/en/binary-log-formats.html&quot;&gt;https://dev.mysql.com/doc/refman/5.6/en/binary-log-formats.html&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://dev.mysql.com/doc/refman/5.6/en/replication-rbr-safe-unsafe.html&quot;&gt;https://dev.mysql.com/doc/refman/5.6/en/replication-rbr-safe-unsafe.html&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Sun, 04 Jun 2017 00:00:00 +0700</pubDate>
        <link>https://llnx.me/technical/2017/06/04/The-MySQL-Binary-log.html</link>
        <guid isPermaLink="true">https://llnx.me/technical/2017/06/04/The-MySQL-Binary-log.html</guid>
        
        
        <category>technical</category>
        
      </item>
    
  </channel>
</rss>
