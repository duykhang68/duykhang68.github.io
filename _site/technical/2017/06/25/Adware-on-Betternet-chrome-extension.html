<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Adware on Betternet chrome extension</title>
    <meta name="description" content="Sometime when clicking to any urls on internet, chrome redirects to ads sites like http://eltrack.pro/azkzkyvodi or something like this. Also see pornographi...">

    <!-- todo: include this into main.css -->
    <link href='https://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href=" /css/main.css ">
    <link rel="canonical" href="https://blog.tracelog.in/technical/2017/06/25/Adware-on-Betternet-chrome-extension.html">
    <link rel="alternate" type="application/rss+xml" title="Hieu's blog" href="https://blog.tracelog.in /feed.xml ">
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script async src="https://blog.tracelog.in/assets/dist/fetch.min.js"></script>
    <!-- <script>
    (function(f, a, t, h, o, m){
	a[h]=a[h]||function(){
		(a[h].q=a[h].q||[]).push(arguments)
	};
	o=f.createElement('script'),
	m=f.getElementsByTagName('script')[0];
	o.async=1; o.src=t; o.id='fathom-script';
	m.parentNode.insertBefore(o,m)
    })(document, window, 'https://analytics.tracelog.in/tracker.js', 'fathom');
    fathom('trackPageview');
    </script> -->

    <!-- Fathom - simple website analytics - https://github.com/usefathom/fathom -->
    <script>
    (function(f, a, t, h, o, m){
        a[h]=a[h]||function(){
            (a[h].q=a[h].q||[]).push(arguments)
        };
        o=f.createElement('script'),
        m=f.getElementsByTagName('script')[0];
        o.async=1; o.src=t; o.id='fathom-script';
        m.parentNode.insertBefore(o,m)
    })(document, window, 'https://analytics.tracelog.in/tracker.js', 'fathom');
    fathom('set', 'siteId', 'WLEYN');
    fathom('trackPageview');
    </script>
    <!-- / Fathom -->

    <script src="//instant.page/1.1.0" type="module" integrity="sha384-EwBObn5QAxP8f09iemwAJljc+sU+eUXeL9vSBw1eNmVarwhKk2F9vBEpaN9rsrtp"></script>
</head>

  <body>
    <div class="page-content">
      <div class="container">
        <div class="three columns">
          <header class="site-header">

  <div class="nav">
    
    <label for="menu-toggle" class="menu-icon">
        <!--div data-icon="ei-navicon"></div-->
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
    </label>
    <input type="checkbox" id="menu-toggle">

    <div class="top-bar fixed">
      <nav>
        <ul class="page-link">
          <li><a href="/">Home</a></li>
          <li><a href="/archive">Posts</a></li>
          <li><a href="/about">About</a></li>
          <li><a href="/photography">Photo</a></li>
          <li><a href="/friends">Friends</a></li>
          <li><a href="/2020-hireme" style="display: none; color: white;font-size: 15px;padding: 2px;background-color: #C25;">hireme-web</a></span></li>
          <li><a href="/resume/2020-hireme.pdf" style="color: white;font-size: 15px;padding: 2px;background-color: #C25;">Hire me</a></span></li>
          <li><a href="/WhatTheFuck">WhatTheFuck</a></li>
        </ul>
      </nav>
    </div>

  </div>
</header>

        </div>

        <div class="nine columns" style="z-index:100;">
          <div class="wrapper">
            <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="article_header">
    <h1 class="special_title" itemprop="name headline">Adware on Betternet chrome extension</h1>
    <time class="post_date">[Sunday 25 June 2017] - technical - 5 min read</time>
  </header>

  <div class="article-content" itemprop="articleBody">
    <p>Sometime when clicking to any urls on internet, chrome redirects to ads sites like <a href="http://eltrack.pro/azkzkyvodi">http://eltrack.pro/azkzkyvodi</a> or something like this. Also see <code class="highlighter-rouge">pornographic ads</code> on new tab</p>

<ul>
  <li>Mac OS Sierra 10.12.5 (16F73)</li>
  <li>Chrome Version 59.0.3071.109 (Official Build) (64-bit)</li>
</ul>

<blockquote>
  <p>TL;DR: Remove Betternet out of chrome</p>
</blockquote>

<p><img src="/assets/img/betternet-adware-links.webp" alt="" /></p>

<!--description-->

<h2 id="steps-to-debug-and-figure-out-adware">Steps to debug and figure out adware</h2>
<p><strong>Step 1.</strong> Hold ads site on tab, don’t close it because it’s hard to find logs later</p>

<p><strong>Step 2.</strong> Open <strong>Chrome DevTools</strong>, go to <code class="highlighter-rouge">console</code> tab</p>

<p><strong>Step 3.</strong> I saw chrome has some unknown logs from <code class="highlighter-rouge">insertion.js:189</code>, comes from extension with ID = <code class="highlighter-rouge">gjknjjomckknofjidppipffbpoekiipm</code></p>

<p><img src="/assets/img/betternet-adware-logs.webp" alt="" /></p>

<p><strong>Step 4.</strong> Goto <a href="chrome://extensions/">chrome://extensions/</a> and find <code class="highlighter-rouge">gjknjjomckknofjidppipffbpoekiipm</code>, it’s <strong>betternet</strong></p>

<p><strong>Step 5.</strong> Figure out more, google search with term “betternet extension adware”, here is best write-up about this <a href="https://restoreprivacy.com/betternet-review/">https://restoreprivacy.com/betternet-review/</a></p>

<p><img src="/assets/img/betternet-adware.webp" alt="" /></p>

<p><strong>Step 6.</strong> Expand source of <a href="http://eltrack.pro">http://eltrack.pro</a></p>
<ul>
  <li>
    <p>My browser is redirected/injected to a fucking FB campaign, <strong>Pixel ID</strong> = <code class="highlighter-rouge">1666009176948198</code></p>

    <div class="language-html highlighter-rouge"><pre class="highlight"><code>  <span class="c">&lt;!-- Facebook Pixel Code --&gt;</span>
  <span class="nt">&lt;script&gt;</span>
  <span class="o">!</span><span class="kd">function</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">v</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">t</span><span class="p">,</span><span class="nx">s</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">fbq</span><span class="p">)</span><span class="k">return</span><span class="p">;</span><span class="nx">n</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">fbq</span><span class="o">=</span><span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span><span class="nx">n</span><span class="p">.</span><span class="nx">callMethod</span><span class="p">?</span> <span class="nx">n</span><span class="p">.</span><span class="nx">callMethod</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span><span class="nx">arguments</span><span class="p">):</span><span class="nx">n</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)}</span>
  <span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">_fbq</span><span class="p">)</span><span class="nx">f</span><span class="p">.</span><span class="nx">_fbq</span><span class="o">=</span><span class="nx">n</span><span class="p">;</span>
  <span class="nx">n</span><span class="p">.</span><span class="nx">push</span><span class="o">=</span><span class="nx">n</span><span class="p">;</span><span class="nx">n</span><span class="p">.</span><span class="nx">loaded</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="nx">n</span><span class="p">.</span><span class="nx">version</span><span class="o">=</span><span class="s1">'2.0'</span><span class="p">;</span><span class="nx">n</span><span class="p">.</span><span class="nx">queue</span><span class="o">=</span><span class="p">[];</span><span class="nx">t</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span><span class="nx">t</span><span class="p">.</span><span class="nx">async</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span>
  <span class="nx">t</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="nx">v</span><span class="p">;</span><span class="nx">s</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">e</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span><span class="nx">s</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="nx">s</span><span class="p">)}(</span><span class="nb">window</span><span class="p">,</span>
  <span class="nb">document</span><span class="p">,</span><span class="s1">'script'</span><span class="p">,</span><span class="s1">'https://connect.facebook.net/en_US/fbevents.js'</span><span class="p">);</span>
  <span class="nx">fbq</span><span class="p">(</span><span class="s1">'init'</span><span class="p">,</span> <span class="s1">'1666009176948198'</span><span class="p">);</span> <span class="c1">// Insert your pixel ID here.</span>
  <span class="nx">fbq</span><span class="p">(</span><span class="s1">'track'</span><span class="p">,</span> <span class="s1">'PageView'</span><span class="p">);</span>
  <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;noscript&gt;&lt;img</span> <span class="na">height=</span><span class="s">"1"</span> <span class="na">width=</span><span class="s">"1"</span> <span class="na">style=</span><span class="s">"display:none"</span>
  <span class="na">src=</span><span class="s">"https://www.facebook.com/tr?id=1666009176948198&amp;ev=PageView&amp;noscript=1"</span>
  <span class="nt">/&gt;&lt;/noscript&gt;</span>
  <span class="c">&lt;!-- DO NOT MODIFY --&gt;</span>
  <span class="c">&lt;!-- End Facebook Pixel Code --&gt;</span>
</code></pre>
    </div>
  </li>
  <li>
    <p>This url <code class="highlighter-rouge">tintuc-vn.com</code> in source of ads site</p>

    <div class="language-sql highlighter-rouge"><pre class="highlight"><code>  <span class="err">❯❯</span> <span class="n">nslookup</span> <span class="n">tintuc</span><span class="o">-</span><span class="n">vn</span><span class="p">.</span><span class="n">com</span>
  <span class="n">Server</span><span class="p">:</span>		<span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span>
  <span class="n">Address</span><span class="p">:</span>	<span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="o">#</span><span class="mi">53</span>

  <span class="n">Non</span><span class="o">-</span><span class="n">authoritative</span> <span class="n">answer</span><span class="p">:</span>
  <span class="n">Name</span><span class="p">:</span>	<span class="n">tintuc</span><span class="o">-</span><span class="n">vn</span><span class="p">.</span><span class="n">com</span>
  <span class="n">Address</span><span class="p">:</span> <span class="mi">136</span><span class="p">.</span><span class="mi">243</span><span class="p">.</span><span class="mi">94</span><span class="p">.</span><span class="mi">239</span>
</code></pre>
    </div>
  </li>
  <li>
    <p>whois this domain: <a href="https://whois.icann.org/en/lookup?name=tintuc-vn.com">https://whois.icann.org/en/lookup?name=tintuc-vn.com</a></p>
  </li>
  <li>
    <p>which ports are opened?</p>

    <div class="language-sql highlighter-rouge"><pre class="highlight"><code>  <span class="err">❯❯</span> <span class="n">sudo</span> <span class="n">nmap</span> <span class="mi">136</span><span class="p">.</span><span class="mi">243</span><span class="p">.</span><span class="mi">94</span><span class="p">.</span><span class="mi">239</span>
  <span class="n">Password</span><span class="p">:</span>

  <span class="n">Starting</span> <span class="n">Nmap</span> <span class="mi">7</span><span class="p">.</span><span class="mi">40</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span> <span class="p">)</span> <span class="k">at</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">25</span> <span class="mi">16</span><span class="p">:</span><span class="mi">58</span> <span class="o">+</span><span class="mi">07</span>
  <span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="k">static</span><span class="p">.</span><span class="mi">239</span><span class="p">.</span><span class="mi">94</span><span class="p">.</span><span class="mi">243</span><span class="p">.</span><span class="mi">136</span><span class="p">.</span><span class="n">clients</span><span class="p">.</span><span class="n">your</span><span class="o">-</span><span class="n">server</span><span class="p">.</span><span class="n">de</span> <span class="p">(</span><span class="mi">136</span><span class="p">.</span><span class="mi">243</span><span class="p">.</span><span class="mi">94</span><span class="p">.</span><span class="mi">239</span><span class="p">)</span>
  <span class="k">Host</span> <span class="k">is</span> <span class="n">up</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">53</span><span class="n">s</span> <span class="n">latency</span><span class="p">).</span>
  <span class="k">Not</span> <span class="n">shown</span><span class="p">:</span> <span class="mi">987</span> <span class="n">closed</span> <span class="n">ports</span>
  <span class="n">PORT</span>     <span class="k">STATE</span> <span class="n">SERVICE</span>
  <span class="mi">21</span><span class="o">/</span><span class="n">tcp</span>   <span class="k">open</span>  <span class="n">ftp</span>
  <span class="mi">22</span><span class="o">/</span><span class="n">tcp</span>   <span class="k">open</span>  <span class="n">ssh</span>
  <span class="mi">25</span><span class="o">/</span><span class="n">tcp</span>   <span class="k">open</span>  <span class="n">smtp</span>
  <span class="mi">53</span><span class="o">/</span><span class="n">tcp</span>   <span class="k">open</span>  <span class="k">domain</span>
  <span class="mi">80</span><span class="o">/</span><span class="n">tcp</span>   <span class="k">open</span>  <span class="n">http</span>
  <span class="mi">106</span><span class="o">/</span><span class="n">tcp</span>  <span class="k">open</span>  <span class="n">pop3pw</span>
  <span class="mi">110</span><span class="o">/</span><span class="n">tcp</span>  <span class="k">open</span>  <span class="n">pop3</span>
  <span class="mi">143</span><span class="o">/</span><span class="n">tcp</span>  <span class="k">open</span>  <span class="n">imap</span>
  <span class="mi">443</span><span class="o">/</span><span class="n">tcp</span>  <span class="k">open</span>  <span class="n">https</span>
  <span class="mi">465</span><span class="o">/</span><span class="n">tcp</span>  <span class="k">open</span>  <span class="n">smtps</span>
  <span class="mi">993</span><span class="o">/</span><span class="n">tcp</span>  <span class="k">open</span>  <span class="n">imaps</span>
  <span class="mi">995</span><span class="o">/</span><span class="n">tcp</span>  <span class="k">open</span>  <span class="n">pop3s</span>
  <span class="mi">8443</span><span class="o">/</span><span class="n">tcp</span> <span class="k">open</span>  <span class="n">https</span><span class="o">-</span><span class="n">alt</span>

  <span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="k">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="k">in</span> <span class="mi">60</span><span class="p">.</span><span class="mi">24</span> <span class="n">seconds</span>
</code></pre>
    </div>
  </li>
</ul>

<h2 id="what-should-i-do">What should I do?</h2>
<ul>
  <li>Remove this Betternet chrome extension</li>
  <li>Report to google</li>
</ul>

    <div id="gitment-container"></div>
    <script async src="https://comments.app/js/widget.js?2" data-comments-app-website="iVXMIkzG" data-limit="10" data-color="E47911" data-dislikes="1" data-colorful="1"></script>
  </div>

  <footer class="article-footer">

  <hr/>

  <section class="author">
  <div class="authorimage box" style="background: url(/assets/img/avatar.webp)"></div>
  <div class="authorinfo box">
    <p class="bio" style="color: #222">
      I'm an engineer who likes learning, discussing, and solving problems. These days, I'm focusing on DevOps because I'd love to help ensure that services stay up and running, while continuing to ship software to customers rapidly. I also have a passion for building robust infrastructure at world scale.
    </p>
    <a class="github-button" href="https://github.com/hieuhtr" data-size="large" data-show-count="true" aria-label="Follow @hieuhtr on GitHub">Follow @hieuhtr</a>
  </div>
</section>


  </footer>

</article>


          </div>
        </div>
      </div>
    </div>
  </body>
</html>
